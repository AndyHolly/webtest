<!DOCTYPE html>
<html style="font-size: 16px;">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="keywords" content="ข้อมูล">
    <meta name="description" content="">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <title>ยกเลิกการลงทะเบียน</title>
    <link rel="stylesheet" href="nicepage.css" media="screen">
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Prompt:wght@100&display=swap" rel="stylesheet">
<link rel="stylesheet" href="page.css" media="screen">
    <script class="u-script" type="text/javascript" src="jquery.js" defer=""></script>
    <script class="u-script" type="text/javascript" src="nicepage.js" defer=""></script>
    <meta name="generator" content="Nicepage 4.11.3, nicepage.com">
    <link id="u-theme-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,500,500i,600,600i,700,700i,800,800i">
    
    
    <script type="application/ld+json">{
		"@context": "http://schema.org",
		"@type": "Organization",
		"name": ""
}</script>
    <meta name="theme-color" content="#478ac9">
    <meta property="og:title" content="Contact">
    <meta property="og:type" content="website">
  </head>
  <body class="u-body u-overlap u-xl-mode">
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <script>
      let useUserId =''
      function showData(data) {
        let studentList = document.querySelector('#studentList');
        data.forEach((val,index) => {
          let nameDiv = document.querySelector('#showName');
          let button = document.createElement('button');
          button.innerText = `${val.firstname} ${val.lastName}`
          button.className = 'btnClass'
          button.id = val.studentid
          button.type = "submit"
          button.addEventListener("click", function () {
            submitId(val.studentid)
            console.log("click")
});
          button.value = index
          nameDiv.appendChild(button)
        })
      }
      async function main(){
        console.log('main runned')
        await liff.init({liffId:"1657191323-vqrpJMMn"});
        if(!liff.isLoggedIn()){
            liff.login();
            useUserId  = profile.userId
            useUserId.toString
            console.log('tell to login')
          }else {
            await liff.getProfile().then(profile =>{
            console.log("profile : "+profile)
            useUserId  = profile.userId
            useUserId.toString
           console.log("userId NAJA EIEI : "+useUserId)
          })
          }
          await fetch('https://asclb.dynu.com:3000/lineliff/register/getStudentFromUid', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
  	'user_id': useUserId
  }),
}).then(res => res.json()).then(data => showData(data.data))
      }
      main();
      async function deleteData(id){
       await fetch('https://asclb.dynu.com:3000/lineliff/deletes/', {
  method: 'DELETE',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
  	"user_id": useUserId,
    "studentid": id
  }),
})
console.log("deleted")
window.location.reload();
      }
      function submitId(id){
        if (confirm("คุณต้องการที่จะลบข้อมูลการลงทะเบียนหรือไม่?") == true) {
          deleteData(id);
        } else {
        text = "ยกเลิก";
        } 
      }
    </script>
    <section class="u-align-center u-clearfix u-gradient u-section-1" id="carousel_c529">
      <input id="idForSearch" value="0"type="hidden">
      <div class="u-clearfix u-sheet u-sheet-1">
        <h2 style="margin-bottom: 20px;"class="u-text u-text-default u-text-1">ยกเลิกการลงทะเบียน</h2>
        <script>
        </script>
        <div class="btn"id="showName"> เลือกชื่อนักเรียน : </div>
        <p id ="studentList" class="u-text u-text-default u-text-2"></p>
        <p id ="stuName" class="u-text u-text-default u-text-3"></p>
        <h3 class="u-text u-text-default u-text-4"></h3>
        <div id="checkinDiv" style="overflow-y: auto;overflow-x: auto;height:auto;"class="u-expanded-width u-table u-table-responsive u-table-1">
          <table id="checkinTable" class="u-table-entity">
            <thead class="u-palette-4-base u-table-header u-table-header-1">
              <tr style="height: 57px;">
              </tr>
            </thead>
            <tbody class="u-table-body">
            </tbody>
          </table>
          <script>
          </script>
        </div>
        <h3 class="u-text u-text-default u-text-5"></h3>
        <div id="balanceDiv"style="overflow-y: auto;overflow-x: auto;height:auto;"class="u-expanded-width u-table u-table-responsive u-table-2">
          <table id="balanceTrans"class="u-table-entity">
            <thead class="u-palette-4-base u-table-header u-table-header-2">
              <tr style="height: 55px;">
              </tr>
            </thead>
            <tbody class="u-table-body">
              <tr style="height: 90px;">
              </tr>
            </tbody>
          </table>
          <script>
          </script>
        </div>
        <h3 class="u-text u-text-default u-text-6"></h3>
        <div id="foodDiv"style="overflow-y: auto;overflow-x: auto;height:auto;"class="u-expanded-width u-table u-table-responsive u-table-3">
          <table id="foodCardTrans" class="u-table-entity">
            <thead class="u-palette-4-base u-table-header u-table-header-3">
              <tr style="height: 21px;">
              </tr>
            </thead>
            <tbody class="u-table-body">
            </tbody>
          </table>
          <script>
        </script>
        </div>
        <h3 class="u-text u-text-default u-text-7"></h3>
        <div id="martDiv"style="overflow-y: auto;overflow-x: auto;height:auto;"class="u-expanded-width u-table u-table-responsive u-table-4">
          <table id ="minimartTrans"class="u-table-entity">
            <thead class="u-palette-4-base u-table-header u-table-header-4">
            </thead>
            <tbody class="u-table-body">
            </tbody>
          </table>
          <script>
        </script>
        </div>
      </div>
    </section>
    
  </body>
</html>